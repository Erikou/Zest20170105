{% extends "SEInputBundle::layout.html.twig" %}

{% block title %}Review - {{ parent() }}{% endblock %}

{% block seinput_body %}
  <h2>Review Inputs</h2>

  <div class="row">
    <div class="col-md-8 col-md-offset-2 well">
      <div class="col-md-5">
        <h2> Graphic </h2>
      </div>
      <div class="col-md-7">
        <h3 class="text-danger">
            <i class="glyphicon glyphicon-alert"></i>
            {{ importErrors|length + inputErrors|length + toErrors|length + hourErrors|length }} errors to review!
        </h3>
        <ul class="list-unstyled">
          <li>
            {% if importErrors|length == 0 %}
              <p class="text-success"><i class="glyphicon glyphicon-ok"></i> 0 import error</p>
            {% else %}
              <p class="text-warning"><i class="glyphicon glyphicon-remove"></i> {{ importErrors|length }} import error(s)</p>
            {% endif %}
          </li>
          <li>
            {% if inputErrors|length == 0 %}
              <p class="text-success"><i class="glyphicon glyphicon-ok"></i> 0 input error</p>
            {% else %}
              <p class="text-warning"><i class="glyphicon glyphicon-remove"></i> {{ inputErrors|length }} input error(s)</p>
            {% endif %}
          </li>
          <li>
            {% if toErrors|length == 0 %}
              <p class="text-success"><i class="glyphicon glyphicon-ok"></i> 0 to error</p>
            {% else %}
              <p class="text-warning"><i class="glyphicon glyphicon-remove"></i> {{ toErrors|length }} to error(s)</p>
            {% endif %}
          </li>
          <li>
            {% if hourErrors|length == 0 %}
              <p class="text-success"><i class="glyphicon glyphicon-ok"></i> 0 manhours error</p>
            {% else %}
              <p class="text-warning"><i class="glyphicon glyphicon-remove"></i> {{ hourErrors|length }} manhours error(s)</p>
            {% endif %}
          </li>
        </ul>
      </div>
    </div>
  </div>

  <div id="filters">
    <div class="row">
      <div id="1" class="col-md-8 col-md-offset-2 text-center">
        <h3>
          <a id="" class="label label-primary">All</a>
          <a id="Outbound4" class="label label-default">Outbound4</a>
          <a id="Inbound4" class="label label-default">Inbound4</a>
          <a id="Local" class="label label-default">Local</a>
          <a id="Outbound3" class="label label-default">Outbound3</a>
          <a id="Inbound3" class="label label-default">Inbound3</a>
          <a id="Releasing" class="label label-default">Releasing</a>
        </h3>
      </div>
    </div>
    <div class="row">
      <div id="2" class="col-md-8 col-md-offset-2 text-center">
        <h4>
          <a id="" class="label label-primary">All</a>
          <a id="1" class="label label-default">Shift 1</a>
          <a id="2" class="label label-default">Shift 2</a>
          <a id="3" class="label label-default">Shift 3</a>
        </h4>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col-md-12">
      <!-- Table -->
      <div class="table-responsive">
          <table id="table" class="table table-hover table-striped display">
            <thead>
              <tr>
                <th>Date</th>
                <th>Team</th>
                <th>Shift</th>
                <th>Input</th>
                <th>Manhours</th>
                <th>HC</th>
                <th>TO</th>
                <th>Productivity</th>
                <th>Errors</th>
                <th>Options</th>
              </tr>
            </thead>
            <tbody id="data">
              {% for input in userInputs %}
                <tr>
                  <td>{{ input.dateInput|date('d-m-Y') }}</td>
                  <td>{{ input.team.name }}</td>
                  <td>{{ input.shift.id }}</td>
                  <td><i class="glyphicon glyphicon-ok text-success"></i></td>
                  <td>{{ input.totalHoursInput }}</td>
                  <td>{{ input.inputEntries|length }}</td>
                  <td>{{ input.totalToInput }}</td>
                  <td>{{ input.totalProdInput }}</td>
                  <td>errors</td>
                  <td>options</td>  
                </tr>
              {% endfor %}                
            </tbody>
        </table>
      </div>
    </div>
  </div>

<!-- panel to show when hover error -->
  <div class="col-md-5">
  	<div class="panel panel-hour">
	  <!-- Default panel contents -->
	  <div class="panel-heading">Missing hours</div>
  	  <div class="panel-body">
  	    <p>Some TO lines weren't included into the productivity because the employee hours don't match.</p>
  	    <p>Please find the inputs that cause such errors in the following table, and correct the data in the edit section of manhours input (requires validation from a manager). If the issue is validated as is, the unincluded TO lines will be lost.</p>  
  	  </div>
  	</div>
  </div>

  <div class="col-md-5">
  	<div class="panel panel-input">
	  <!-- Default panel contents -->
	  <div class="panel-heading">Missing Inputs</div>
  	  <div class="panel-body">
  	    <p>Some Manhours inputs are missing in the database.</p>
  	    <p>Please find the according team and date, and add a new input in the appropriate section. If the issue is validated as is, the productivity for this team will counted as 0.</p>  
  	  </div>
  	</div>
  </div>

  <div class="col-md-2">
  	<div class="panel panel-import">
	  <!-- Default panel contents -->
	  <div class="panel-heading">Missing imports</div>
  	  <div class="panel-body">
  	    <p>The following imports have not been made, please process.</p>
  	  </div>
  	</div>
  </div>

{% endblock %}

{% block javascripts %}
  {{ parent() }}

  <script type="text/javascript">
    //global variable containing details of all employees
    var listInputs = [];
    var singleData = [];
    {% for input in userInputs %}
    singleData = [{{input.id|json_encode|raw}}, {{input.dateInput|json_encode|raw}}, {{input.inputEntries|length|json_encode|raw}},{{input.team.id|json_encode|raw}},{{input.shift.id|json_encode|raw}},{{input.user.id|json_encode|raw}}, {{input.totalHoursInput|json_encode|raw}}, {{input.totalToInput|json_encode|raw}}, {{input.totalProdInput|json_encode|raw}}];
    listInputs.push(singleData);
    {% endfor %}
  </script>
  <script type="text/javascript" charset="utf8" src="//cdn.datatables.net/1.10.7/js/jquery.dataTables.js"></script>
  {% javascripts '@SEInputBundle/Resources/public/js/review.js' %}
    <script type="text/javascript" src="{{ asset_url }}"></script>
  {% endjavascripts %}
{% endblock %}