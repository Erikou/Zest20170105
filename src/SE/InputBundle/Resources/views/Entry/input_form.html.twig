{% extends "SEInputBundle:Entry:input.html.twig" %}

{% macro entryCollection(entry) %}
  <tr>
    <td>#</td>
    <td>
        {{ form_widget(entry.employee, {'attr': {'class': 'form-control'}}) }}
        <p>SESA000000</p>
        {{ form_row(entry.presence.present) }}
        {{ form_widget(entry.presence.absenceReason, {'attr': {'class': 'form-control'}}) }}
    </td>
    <td>
      <table class="table table-hover table-striped">
        <thead>
          <tr>
              <th>Activity</th>
              <th>Hours</th>
              <th>Transfer Out</th>
              <th>Workstation</th>
              <th>
                <a href=# id="add" class="btn btn-success" data-target="activities-prototype">
                  <i class="glyphicon glyphicon-plus"></i>
                </a>
              </th>
            </tr>
        </thead>
        <tbody id="activities">
          <div 
            id="activities-prototype"
            data-prototype="{{ _self.activityCollection(entry.activity_hours.vars.prototype) | e }}">
              {#{{ form_row(entry.vars.prototype.children['activity_hours'].vars.prototype) | e }}">#}
              {% for activity in entry.activity_hours %}
                {{ _self.activityCollection(activity) }}
              {% endfor %}
          </div>
        </tbody>
      </table>
    </td>
    <td>
      {{ form_widget(entry.comments, {'attr': {'class': 'form-control'}}) }}
      <br>
      <a href=# id="rmv" class="btn btn-danger" data-target="entries-prototype">
        <i class="glyphicon glyphicon-trash"></i>
      </a>
      <a href=# id="info" class="btn btn-info">
        <i class="glyphicon glyphicon-info-sign"></i>
      </a>
    </td>
    {{ form_widget(entry) }}
  </tr>
{% endmacro %}

{% macro activityCollection(activity) %}
  <tr>
    <td>{{ form_widget(activity.activity, {'attr': {'class': 'form-control'}}) }} </td>
    <td>
      {{ form_widget(activity.regularHours, {'attr': {'class': 'form-control'}}) }}
      {{ form_widget(activity.otHours, {'attr': {'class': 'form-control'}}) }}
      <br>
      {{ form_widget(activity.otStartTime) }}
      {{ form_widget(activity.otEndTime) }}
    </td>
    <td>
      {{ form_widget(activity.team, {'attr': {'class': 'form-control'}}) }}
      {{ form_widget(activity.shift, {'attr': {'class': 'form-control'}}) }}
    </td>
    <td>
      {{ form_widget(activity.zone, {'attr': {'class': 'form-control'}}) }}
      {{ form_widget(activity.workstation, {'attr': {'class': 'form-control'}}) }}
    </td>
    <td>
      <a href=# id="rmv" class="btn btn-danger" data-target="activities-prototype">
        <i class="glyphicon glyphicon-trash"></i>
      </a>
    </td>   
    {{ form_widget(activity) }}
  </tr>
{% endmacro %}

 {% block seinput_form %}

  <div class="well">
   {{ form_start(form, {'attr': {'class': 'form-horizontal'}}) }}

    {{ form_errors(form) }}

     <div class="form-group">
        {{ form_label(form.user, "User", {'label_attr': {'class': 'col-sm-3 control-label'}}) }}
        {{ form_errors(form.user) }}
        <div class="col-sm-4">
          {{ form_widget(form.user, {'attr': {'class': 'form-control'}}) }}
        </div>
    </div>
    
    <div class="form-group">
     
     <div class="table-responsive">
        <table class="table table-hover table-striped">
          <thead>
            <tr>
              <th>#</th>
              <th>Employee</th>
              <th>Activity Hours</th>
              <th>Comments</th>
            </tr>
          </thead>
          <tbody id="entries">
            <div 
            id="entries-prototype"
            data-prototype="{{ _self.entryCollection(form.input_entries.vars.prototype)|e }}">
              {% for entry in form.input_entries %}
                {{ _self.entryCollection(entry) }}
              {% endfor %}
            </div>
          </tbody>
        </table>
      </div>
      <p>
        <a href=# id="add" class="btn btn-success" data-target="entries-prototype">
          <i class="glyphicon glyphicon-plus"></i>
        </a>
      </p> 
    </div>
 
    <div class="form-group">
      {{ form_widget(form.save, {'attr': {'class': 'btn btn-success'}}) }}
    </div>
    
    {{ form_rest(form) }}
    {{ form_end(form) }}
  </div>



<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
{% javascripts '@SEInputBundle/Resources/public/js/*' %}
    <script type="text/javascript" src="{{ asset_url }}"></script>
{% endjavascripts %}

{% endblock %}